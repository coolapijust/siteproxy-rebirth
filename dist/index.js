var ue=Object.freeze,fe=Object.defineProperty;var l=(e,t)=>fe(e,"name",{value:t,configurable:!0});var de=(e,t)=>ue(fe(e,"raw",{value:ue(t||e.slice())}));var Y=l((e,t,r)=>(s,n)=>{let i=-1;return o(0);async function o(h){if(h<=i)throw new Error("next() called multiple times");i=h;let a,c=!1,u;if(e[h]?(u=e[h][0][0],s.req.routeIndex=h):u=h===e.length&&n||void 0,u)try{a=await u(s,()=>o(h+1))}catch(f){if(f instanceof Error&&t)s.error=f,a=await t(f,s),c=!0;else throw f}else s.finalized===!1&&r&&(a=await r(s));return a&&(s.finalized===!1||c)&&(s.res=a),s}},"compose");var pe=Symbol();var ge=l(async(e,t=Object.create(null))=>{let{all:r=!1,dot:s=!1}=t,i=(e instanceof D?e.raw.headers:e.headers).get("Content-Type");return i?.startsWith("multipart/form-data")||i?.startsWith("application/x-www-form-urlencoded")?qe(e,{all:r,dot:s}):{}},"parseBody");async function qe(e,t){let r=await e.formData();return r?ze(r,t):{}}l(qe,"parseFormData");function ze(e,t){let r=Object.create(null);return e.forEach((s,n)=>{t.all||n.endsWith("[]")?Fe(r,n,s):r[n]=s}),t.dot&&Object.entries(r).forEach(([s,n])=>{s.includes(".")&&(Ke(r,s,n),delete r[s])}),r}l(ze,"convertFormDataToBodyData");var Fe=l((e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:t.endsWith("[]")?e[t]=[r]:e[t]=r},"handleParsingAllValues"),Ke=l((e,t,r)=>{let s=e,n=t.split(".");n.forEach((i,o)=>{o===n.length-1?s[i]=r:((!s[i]||typeof s[i]!="object"||Array.isArray(s[i])||s[i]instanceof File)&&(s[i]=Object.create(null)),s=s[i])})},"handleParsingNestedValues");var J=l(e=>{let t=e.split("/");return t[0]===""&&t.shift(),t},"splitPath"),me=l(e=>{let{groups:t,path:r}=Ve(e),s=J(r);return Ge(s,t)},"splitRoutingPath"),Ve=l(e=>{let t=[];return e=e.replace(/\{[^}]+\}/g,(r,s)=>{let n=`@${s}`;return t.push([n,r]),n}),{groups:t,path:e}},"extractGroupsFromPath"),Ge=l((e,t)=>{for(let r=t.length-1;r>=0;r--){let[s]=t[r];for(let n=e.length-1;n>=0;n--)if(e[n].includes(s)){e[n]=e[n].replace(s,t[r][1]);break}}return e},"replaceGroupMarks"),M={},we=l((e,t)=>{if(e==="*")return"*";let r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){let s=`${e}#${t}`;return M[s]||(r[2]?M[s]=t&&t[0]!==":"&&t[0]!=="*"?[s,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]:M[s]=[e,r[1],!0]),M[s]}return null},"getPattern"),_=l((e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},"tryDecode"),Ye=l(e=>_(e,decodeURI),"tryDecodeURI"),X=l(e=>{let t=e.url,r=t.indexOf("/",t.indexOf(":")+4),s=r;for(;s<t.length;s++){let n=t.charCodeAt(s);if(n===37){let i=t.indexOf("?",s),o=t.slice(r,i===-1?void 0:i);return Ye(o.includes("%25")?o.replace(/%25/g,"%2525"):o)}else if(n===63)break}return t.slice(r,s)},"getPath");var ye=l(e=>{let t=X(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},"getPathNoStrict"),S=l((e,t,...r)=>(r.length&&(t=S(t,...r)),`${e?.[0]==="/"?"":"/"}${e}${t==="/"?"":`${e?.at(-1)==="/"?"":"/"}${t?.[0]==="/"?t.slice(1):t}`}`),"mergePath"),I=l(e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;let t=e.split("/"),r=[],s="";return t.forEach(n=>{if(n!==""&&!/\:/.test(n))s+="/"+n;else if(/\:/.test(n))if(/\?/.test(n)){r.length===0&&s===""?r.push("/"):r.push(s);let i=n.replace("?","");s+="/"+i,r.push(s)}else s+="/"+n}),r.filter((n,i,o)=>o.indexOf(n)===i)},"checkOptionalParameter"),Q=l(e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?_(e,C):e):e,"_decodeURI"),be=l((e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let o=e.indexOf("?",8);if(o===-1)return;for(e.startsWith(t,o+1)||(o=e.indexOf(`&${t}`,o+1));o!==-1;){let h=e.charCodeAt(o+t.length+1);if(h===61){let a=o+t.length+2,c=e.indexOf("&",a);return Q(e.slice(a,c===-1?void 0:c))}else if(h==38||isNaN(h))return"";o=e.indexOf(`&${t}`,o+1)}if(s=/[%+]/.test(e),!s)return}let n={};s??=/[%+]/.test(e);let i=e.indexOf("?",8);for(;i!==-1;){let o=e.indexOf("&",i+1),h=e.indexOf("=",i);h>o&&o!==-1&&(h=-1);let a=e.slice(i+1,h===-1?o===-1?void 0:o:h);if(s&&(a=Q(a)),i=o,a==="")continue;let c;h===-1?c="":(c=e.slice(h+1,o===-1?void 0:o),s&&(c=Q(c))),r?(n[a]&&Array.isArray(n[a])||(n[a]=[]),n[a].push(c)):n[a]??=c}return t?n[t]:n},"_getQueryParam"),xe=be,ve=l((e,t)=>be(e,t,!0),"getQueryParams"),C=decodeURIComponent;var Ee=l(e=>_(e,C),"tryDecodeURIComponent"),D=l(class{raw;#t;#e;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e,this.path=t,this.#e=r,this.#t={}}param(e){return e?this.#r(e):this.#i()}#r(e){let t=this.#e[0][this.routeIndex][1][e],r=this.#n(t);return r&&/\%/.test(r)?Ee(r):r}#i(){let e={},t=Object.keys(this.#e[0][this.routeIndex][1]);for(let r of t){let s=this.#n(this.#e[0][this.routeIndex][1][r]);s!==void 0&&(e[r]=/\%/.test(s)?Ee(s):s)}return e}#n(e){return this.#e[1]?this.#e[1][e]:e}query(e){return xe(this.url,e)}queries(e){return ve(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;let t={};return this.raw.headers.forEach((r,s)=>{t[s]=r}),t}async parseBody(e){return this.bodyCache.parsedBody??=await ge(this,e)}#s=e=>{let{bodyCache:t,raw:r}=this,s=t[e];if(s)return s;let n=Object.keys(t)[0];return n?t[n].then(i=>(n==="json"&&(i=JSON.stringify(i)),new Response(i)[e]())):t[e]=r[e]()};json(){return this.#s("text").then(e=>JSON.parse(e))}text(){return this.#s("text")}arrayBuffer(){return this.#s("arrayBuffer")}blob(){return this.#s("blob")}formData(){return this.#s("formData")}addValidatedData(e,t){this.#t[e]=t}valid(e){return this.#t[e]}get url(){return this.raw.url}get method(){return this.raw.method}get[pe](){return this.#e}get matchedRoutes(){return this.#e[0].map(([[,e]])=>e)}get routePath(){return this.#e[0].map(([[,e]])=>e)[this.routeIndex].path}},"HonoRequest");var Z={Stringify:1,BeforeStream:2,Stream:3},A=l((e,t)=>{let r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},"raw"),Qe=/[&<>'"]/,Re=l(async(e,t)=>{let r="";t||=[];let s=await Promise.all(e);for(let n=s.length-1;r+=s[n],n--,!(n<0);n--){let i=s[n];typeof i=="object"&&t.push(...i.callbacks||[]);let o=i.isEscaped;if(i=await(typeof i=="object"?i.toString():i),typeof i=="object"&&t.push(...i.callbacks||[]),i.isEscaped??o)r+=i;else{let h=[r];N(i,h),r=h[0]}}return A(r,t)},"stringBufferToString"),N=l((e,t)=>{let r=e.search(Qe);if(r===-1){t[0]+=e;return}let s,n,i=0;for(n=r;n<e.length;n++){switch(e.charCodeAt(n)){case 34:s="&quot;";break;case 39:s="&#39;";break;case 38:s="&amp;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}t[0]+=e.substring(i,n)+s,i=n+1}t[0]+=e.substring(i,n)},"escapeToBuffer"),Se=l(e=>{let t=e.callbacks;if(!t?.length)return e;let r=[e],s={};return t.forEach(n=>n({phase:Z.Stringify,buffer:r,context:s})),r[0]},"resolveCallbackSync"),ee=l(async(e,t,r,s,n)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));let i=e.callbacks;if(!i?.length)return Promise.resolve(e);n?n[0]+=e:n=[e];let o=Promise.all(i.map(h=>h({phase:t,buffer:n,context:s}))).then(h=>Promise.all(h.filter(Boolean).map(a=>ee(a,t,!1,s,n))).then(()=>n[0]));return r?A(await o,i):o},"resolveCallback");var Je="text/plain; charset=UTF-8",te=l((e,t)=>({"Content-Type":e,...t}),"setDefaultContentType"),Oe=l(class{#t;#e;env={};#r;finalized=!1;error;#i;#n;#s;#l;#c;#h;#a;#u;#f;constructor(e,t){this.#t=e,t&&(this.#n=t.executionCtx,this.env=t.env,this.#h=t.notFoundHandler,this.#f=t.path,this.#u=t.matchResult)}get req(){return this.#e??=new D(this.#t,this.#f,this.#u),this.#e}get event(){if(this.#n&&"respondWith"in this.#n)return this.#n;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#n)return this.#n;throw Error("This context has no ExecutionContext")}get res(){return this.#s||=new Response(null,{headers:this.#a??=new Headers})}set res(e){if(this.#s&&e){e=new Response(e.body,e);for(let[t,r]of this.#s.headers.entries())if(t!=="content-type")if(t==="set-cookie"){let s=this.#s.headers.getSetCookie();e.headers.delete("set-cookie");for(let n of s)e.headers.append("set-cookie",n)}else e.headers.set(t,r)}this.#s=e,this.finalized=!0}render=(...e)=>(this.#c??=t=>this.html(t),this.#c(...e));setLayout=e=>this.#l=e;getLayout=()=>this.#l;setRenderer=e=>{this.#c=e};header=(e,t,r)=>{this.finalized&&(this.#s=new Response(this.#s.body,this.#s));let s=this.#s?this.#s.headers:this.#a??=new Headers;t===void 0?s.delete(e):r?.append?s.append(e,t):s.set(e,t)};status=e=>{this.#i=e};set=(e,t)=>{this.#r??=new Map,this.#r.set(e,t)};get=e=>this.#r?this.#r.get(e):void 0;get var(){return this.#r?Object.fromEntries(this.#r):{}}#o(e,t,r){let s=this.#s?new Headers(this.#s.headers):this.#a??new Headers;if(typeof t=="object"&&"headers"in t){let i=t.headers instanceof Headers?t.headers:new Headers(t.headers);for(let[o,h]of i)o.toLowerCase()==="set-cookie"?s.append(o,h):s.set(o,h)}if(r)for(let[i,o]of Object.entries(r))if(typeof o=="string")s.set(i,o);else{s.delete(i);for(let h of o)s.append(i,h)}let n=typeof t=="number"?t:t?.status??this.#i;return new Response(e,{status:n,headers:s})}newResponse=(...e)=>this.#o(...e);body=(e,t,r)=>this.#o(e,t,r);text=(e,t,r)=>!this.#a&&!this.#i&&!t&&!r&&!this.finalized?new Response(e):this.#o(e,t,te(Je,r));json=(e,t,r)=>this.#o(JSON.stringify(e),t,te("application/json",r));html=(e,t,r)=>{let s=l(n=>this.#o(n,t,te("text/html; charset=UTF-8",r)),"res");return typeof e=="object"?ee(e,Z.Stringify,!1,{}).then(s):s(e)};redirect=(e,t)=>{let r=String(e);return this.header("Location",/[^\x00-\xFF]/.test(r)?encodeURI(r):r),this.newResponse(null,t??302)};notFound=()=>(this.#h??=()=>new Response,this.#h(this))},"Context");var p="ALL",_e="all",Ae=["get","post","put","delete","options","patch"],W="Can not add a route since the matcher is already built.",U=l(class extends Error{},"UnsupportedPathError");var Pe="__COMPOSED_HANDLER";var Xe=l(e=>e.text("404 Not Found",404),"notFoundHandler"),ke=l((e,t)=>{if("getResponse"in e){let r=e.getResponse();return t.newResponse(r.body,r)}return console.error(e),t.text("Internal Server Error",500)},"errorHandler"),Ce=l(class He{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#t="/";routes=[];constructor(t={}){[...Ae,_e].forEach(i=>{this[i]=(o,...h)=>(typeof o=="string"?this.#t=o:this.#i(i,this.#t,o),h.forEach(a=>{this.#i(i,this.#t,a)}),this)}),this.on=(i,o,...h)=>{for(let a of[o].flat()){this.#t=a;for(let c of[i].flat())h.map(u=>{this.#i(c.toUpperCase(),this.#t,u)})}return this},this.use=(i,...o)=>(typeof i=="string"?this.#t=i:(this.#t="*",o.unshift(i)),o.forEach(h=>{this.#i(p,this.#t,h)}),this);let{strict:s,...n}=t;Object.assign(this,n),this.getPath=s??!0?t.getPath??X:ye}#e(){let t=new He({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,t.#r=this.#r,t.routes=this.routes,t}#r=Xe;errorHandler=ke;route(t,r){let s=this.basePath(t);return r.routes.map(n=>{let i;r.errorHandler===ke?i=n.handler:(i=l(async(o,h)=>(await Y([],r.errorHandler)(o,()=>n.handler(o,h))).res,"handler"),i[Pe]=n.handler),s.#i(n.method,n.path,i)}),this}basePath(t){let r=this.#e();return r._basePath=S(this._basePath,t),r}onError=t=>(this.errorHandler=t,this);notFound=t=>(this.#r=t,this);mount(t,r,s){let n,i;s&&(typeof s=="function"?i=s:(i=s.optionHandler,s.replaceRequest===!1?n=l(a=>a,"replaceRequest"):n=s.replaceRequest));let o=i?a=>{let c=i(a);return Array.isArray(c)?c:[c]}:a=>{let c;try{c=a.executionCtx}catch{}return[a.env,c]};n||=(()=>{let a=S(this._basePath,t),c=a==="/"?0:a.length;return u=>{let f=new URL(u.url);return f.pathname=f.pathname.slice(c)||"/",new Request(f,u)}})();let h=l(async(a,c)=>{let u=await r(n(a.req.raw),...o(a));if(u)return u;await c()},"handler");return this.#i(p,S(t,"*"),h),this}#i(t,r,s){t=t.toUpperCase(),r=S(this._basePath,r);let n={basePath:this._basePath,path:r,method:t,handler:s};this.router.add(t,r,[s,n]),this.routes.push(n)}#n(t,r){if(t instanceof Error)return this.errorHandler(t,r);throw t}#s(t,r,s,n){if(n==="HEAD")return(async()=>new Response(null,await this.#s(t,r,s,"GET")))();let i=this.getPath(t,{env:s}),o=this.router.match(n,i),h=new Oe(t,{path:i,matchResult:o,env:s,executionCtx:r,notFoundHandler:this.#r});if(o[0].length===1){let c;try{c=o[0][0][0][0](h,async()=>{h.res=await this.#r(h)})}catch(u){return this.#n(u,h)}return c instanceof Promise?c.then(u=>u||(h.finalized?h.res:this.#r(h))).catch(u=>this.#n(u,h)):c??this.#r(h)}let a=Y(o[0],this.errorHandler,this.#r);return(async()=>{try{let c=await a(h);if(!c.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return c.res}catch(c){return this.#n(c,h)}})()}fetch=(t,...r)=>this.#s(t,r[1],r[0],t.method);request=(t,r,s,n)=>t instanceof Request?this.fetch(r?new Request(t,r):t,s,n):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${S("/",t)}`,r),s,n));fire=()=>{addEventListener("fetch",t=>{t.respondWith(this.#s(t.request,t,void 0,t.request.method))})}},"_Hono");var B=[];function re(e,t){let r=this.buildAllMatchers(),s=l((n,i)=>{let o=r[n]||r[p],h=o[2][i];if(h)return h;let a=i.match(o[0]);if(!a)return[[],B];let c=a.indexOf("",1);return[o[1][c],a]},"match2");return this.match=s,s(e,t)}l(re,"match");var q="[^/]+",H=".*",$="(?:|/.*)",O=Symbol(),Ze=new Set(".\\+*[^]$()");function et(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===H||e===$?1:t===H||t===$?-1:e===q?1:t===q?-1:e.length===t.length?e<t?-1:1:t.length-e.length}l(et,"compareKey");var $e=l(class se{#t;#e;#r=Object.create(null);insert(t,r,s,n,i){if(t.length===0){if(this.#t!==void 0)throw O;if(i)return;this.#t=r;return}let[o,...h]=t,a=o==="*"?h.length===0?["","",H]:["","",q]:o==="/*"?["","",$]:o.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),c;if(a){let u=a[1],f=a[2]||q;if(u&&a[2]&&(f===".*"||(f=f.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(f))))throw O;if(c=this.#r[f],!c){if(Object.keys(this.#r).some(d=>d!==H&&d!==$))throw O;if(i)return;c=this.#r[f]=new se,u!==""&&(c.#e=n.varIndex++)}!i&&u!==""&&s.push([u,c.#e])}else if(c=this.#r[o],!c){if(Object.keys(this.#r).some(u=>u.length>1&&u!==H&&u!==$))throw O;if(i)return;c=this.#r[o]=new se}c.insert(h,r,s,n,i)}buildRegExpStr(){let r=Object.keys(this.#r).sort(et).map(s=>{let n=this.#r[s];return(typeof n.#e=="number"?`(${s})@${n.#e}`:Ze.has(s)?`\\${s}`:s)+n.buildRegExpStr()});return typeof this.#t=="number"&&r.unshift(`#${this.#t}`),r.length===0?"":r.length===1?r[0]:"(?:"+r.join("|")+")"}},"_Node");var je=l(class{#t={varIndex:0};#e=new $e;insert(e,t,r){let s=[],n=[];for(let o=0;;){let h=!1;if(e=e.replace(/\{[^}]+\}/g,a=>{let c=`@\\${o}`;return n[o]=[c,a],o++,h=!0,c}),!h)break}let i=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let o=n.length-1;o>=0;o--){let[h]=n[o];for(let a=i.length-1;a>=0;a--)if(i[a].indexOf(h)!==-1){i[a]=i[a].replace(h,n[o][1]);break}}return this.#e.insert(i,t,s,this.#t,r),s}buildRegExp(){let e=this.#e.buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0,r=[],s=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(n,i,o)=>i!==void 0?(r[++t]=Number(i),"$()"):(o!==void 0&&(s[Number(o)]=++t),"")),[new RegExp(`^${e}`),r,s]}},"Trie");var tt=[/^$/,[],Object.create(null)],Te=Object.create(null);function Le(e){return Te[e]??=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`)}l(Le,"buildWildcardRegExp");function rt(){Te=Object.create(null)}l(rt,"clearWildcardRegExpCache");function st(e){let t=new je,r=[];if(e.length===0)return tt;let s=e.map(c=>[!/\*|\/:/.test(c[0]),...c]).sort(([c,u],[f,d])=>c?1:f?-1:u.length-d.length),n=Object.create(null);for(let c=0,u=-1,f=s.length;c<f;c++){let[d,g,w]=s[c];d?n[g]=[w.map(([y])=>[y,Object.create(null)]),B]:u++;let m;try{m=t.insert(g,u,d)}catch(y){throw y===O?new U(g):y}d||(r[u]=w.map(([y,E])=>{let T=Object.create(null);for(E-=1;E>=0;E--){let[L,b]=m[E];T[L]=b}return[y,T]}))}let[i,o,h]=t.buildRegExp();for(let c=0,u=r.length;c<u;c++)for(let f=0,d=r[c].length;f<d;f++){let g=r[c][f]?.[1];if(!g)continue;let w=Object.keys(g);for(let m=0,y=w.length;m<y;m++)g[w[m]]=h[g[w[m]]]}let a=[];for(let c in o)a[c]=r[o[c]];return[i,a,n]}l(st,"buildMatcherFromPreprocessedRoutes");function P(e,t){if(e){for(let r of Object.keys(e).sort((s,n)=>n.length-s.length))if(Le(r).test(t))return[...e[r]]}}l(P,"findMiddleware");var z=l(class{name="RegExpRouter";#t;#e;constructor(){this.#t={[p]:Object.create(null)},this.#e={[p]:Object.create(null)}}add(e,t,r){let s=this.#t,n=this.#e;if(!s||!n)throw new Error(W);s[e]||[s,n].forEach(h=>{h[e]=Object.create(null),Object.keys(h[p]).forEach(a=>{h[e][a]=[...h[p][a]]})}),t==="/*"&&(t="*");let i=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){let h=Le(t);e===p?Object.keys(s).forEach(a=>{s[a][t]||=P(s[a],t)||P(s[p],t)||[]}):s[e][t]||=P(s[e],t)||P(s[p],t)||[],Object.keys(s).forEach(a=>{(e===p||e===a)&&Object.keys(s[a]).forEach(c=>{h.test(c)&&s[a][c].push([r,i])})}),Object.keys(n).forEach(a=>{(e===p||e===a)&&Object.keys(n[a]).forEach(c=>h.test(c)&&n[a][c].push([r,i]))});return}let o=I(t)||[t];for(let h=0,a=o.length;h<a;h++){let c=o[h];Object.keys(n).forEach(u=>{(e===p||e===u)&&(n[u][c]||=[...P(s[u],c)||P(s[p],c)||[]],n[u][c].push([r,i-a+h+1]))})}}match=re;buildAllMatchers(){let e=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#t)).forEach(t=>{e[t]||=this.#r(t)}),this.#t=this.#e=void 0,rt(),e}#r(e){let t=[],r=e===p;return[this.#t,this.#e].forEach(s=>{let n=s[e]?Object.keys(s[e]).map(i=>[i,s[e][i]]):[];n.length!==0?(r||=!0,t.push(...n)):e!==p&&t.push(...Object.keys(s[p]).map(i=>[i,s[p][i]]))}),r?st(t):null}},"RegExpRouter");var ne=l(class{name="SmartRouter";#t=[];#e=[];constructor(e){this.#t=e.routers}add(e,t,r){if(!this.#e)throw new Error(W);this.#e.push([e,t,r])}match(e,t){if(!this.#e)throw new Error("Fatal error");let r=this.#t,s=this.#e,n=r.length,i=0,o;for(;i<n;i++){let h=r[i];try{for(let a=0,c=s.length;a<c;a++)h.add(...s[a]);o=h.match(e,t)}catch(a){if(a instanceof U)continue;throw a}this.match=h.match.bind(h),this.#t=[h],this.#e=void 0;break}if(i===n)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,o}get activeRouter(){if(this.#e||this.#t.length!==1)throw new Error("No active router has been determined yet.");return this.#t[0]}},"SmartRouter");var j=Object.create(null),De=l(class Me{#t;#e;#r;#i=0;#n=j;constructor(t,r,s){if(this.#e=s||Object.create(null),this.#t=[],t&&r){let n=Object.create(null);n[t]={handler:r,possibleKeys:[],score:0},this.#t=[n]}this.#r=[]}insert(t,r,s){this.#i=++this.#i;let n=this,i=me(r),o=[];for(let h=0,a=i.length;h<a;h++){let c=i[h],u=i[h+1],f=we(c,u),d=Array.isArray(f)?f[0]:c;if(d in n.#e){n=n.#e[d],f&&o.push(f[1]);continue}n.#e[d]=new Me,f&&(n.#r.push(f),o.push(f[1])),n=n.#e[d]}return n.#t.push({[t]:{handler:s,possibleKeys:o.filter((h,a,c)=>c.indexOf(h)===a),score:this.#i}}),n}#s(t,r,s,n){let i=[];for(let o=0,h=t.#t.length;o<h;o++){let a=t.#t[o],c=a[r]||a[p],u={};if(c!==void 0&&(c.params=Object.create(null),i.push(c),s!==j||n&&n!==j))for(let f=0,d=c.possibleKeys.length;f<d;f++){let g=c.possibleKeys[f],w=u[c.score];c.params[g]=n?.[g]&&!w?n[g]:s[g]??n?.[g],u[c.score]=!0}}return i}search(t,r){let s=[];this.#n=j;let i=[this],o=J(r),h=[];for(let a=0,c=o.length;a<c;a++){let u=o[a],f=a===c-1,d=[];for(let g=0,w=i.length;g<w;g++){let m=i[g],y=m.#e[u];y&&(y.#n=m.#n,f?(y.#e["*"]&&s.push(...this.#s(y.#e["*"],t,m.#n)),s.push(...this.#s(y,t,m.#n))):d.push(y));for(let E=0,T=m.#r.length;E<T;E++){let L=m.#r[E],b=m.#n===j?{}:{...m.#n};if(L==="*"){let R=m.#e["*"];R&&(s.push(...this.#s(R,t,m.#n)),R.#n=b,d.push(R));continue}let[We,le,k]=L;if(!u&&!(k instanceof RegExp))continue;let x=m.#e[We],Ue=o.slice(a).join("/");if(k instanceof RegExp){let R=k.exec(Ue);if(R){if(b[le]=R[0],s.push(...this.#s(x,t,m.#n,b)),Object.keys(x.#e).length){x.#n=b;let Be=R[0].match(/\//)?.length??0;(h[Be]||=[]).push(x)}continue}}(k===!0||k.test(u))&&(b[le]=u,f?(s.push(...this.#s(x,t,b,m.#n)),x.#e["*"]&&s.push(...this.#s(x.#e["*"],t,b,m.#n))):(x.#n=b,d.push(x)))}}i=d.concat(h.shift()??[])}return s.length>1&&s.sort((a,c)=>a.score-c.score),[s.map(({handler:a,params:c})=>[a,c])]}},"_Node");var ie=l(class{name="TrieRouter";#t;constructor(){this.#t=new De}add(e,t,r){let s=I(t);if(s){for(let n=0,i=s.length;n<i;n++)this.#t.insert(e,s[n],r);return}this.#t.insert(e,t,r)}match(e,t){return this.#t.search(e,t)}},"TrieRouter");var oe=l(class extends Ce{constructor(e={}){super(e),this.router=e.router??new ne({routers:[new z,new ie]})}},"Hono");var Ie=l(e=>{let r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},s=(i=>typeof i=="string"?i==="*"?()=>i:o=>i===o?o:null:typeof i=="function"?i:o=>i.includes(o)?o:null)(r.origin),n=(i=>typeof i=="function"?i:Array.isArray(i)?()=>i:()=>[])(r.allowMethods);return l(async function(o,h){function a(u,f){o.res.headers.set(u,f)}l(a,"set");let c=await s(o.req.header("origin")||"",o);if(c&&a("Access-Control-Allow-Origin",c),r.credentials&&a("Access-Control-Allow-Credentials","true"),r.exposeHeaders?.length&&a("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),o.req.method==="OPTIONS"){r.origin!=="*"&&a("Vary","Origin"),r.maxAge!=null&&a("Access-Control-Max-Age",r.maxAge.toString());let u=await n(o.req.header("origin")||"",o);u.length&&a("Access-Control-Allow-Methods",u.join(","));let f=r.allowHeaders;if(!f?.length){let d=o.req.header("Access-Control-Request-Headers");d&&(f=d.split(/\s*,\s*/))}return f?.length&&(a("Access-Control-Allow-Headers",f.join(",")),o.res.headers.append("Vary","Access-Control-Request-Headers")),o.res.headers.delete("Content-Length"),o.res.headers.delete("Content-Type"),new Response(null,{headers:o.res.headers,status:204,statusText:"No Content"})}await h(),r.origin!=="*"&&o.header("Vary","Origin",{append:!0})},"cors2")},"cors");var F=l((e,...t)=>{let r=[""];for(let s=0,n=e.length-1;s<n;s++){r[0]+=e[s];let i=Array.isArray(t[s])?t[s].flat(1/0):[t[s]];for(let o=0,h=i.length;o<h;o++){let a=i[o];if(typeof a=="string")N(a,r);else if(typeof a=="number")r[0]+=a;else{if(typeof a=="boolean"||a===null||a===void 0)continue;if(typeof a=="object"&&a.isEscaped)if(a.callbacks)r.unshift("",a);else{let c=a.toString();c instanceof Promise?r.unshift("",c):r[0]+=c}else a instanceof Promise?r.unshift("",a):N(a.toString(),r)}}}return r[0]+=e.at(-1),r.length===1?"callbacks"in r?A(Se(A(r[0],r.callbacks))):A(r[0]):Re(r,r.callbacks)},"html");var nt=/^[\w!#$%&'*.^`|~+-]+$/,it=/^[ !#-:<-[\]-~]*$/,ae=l((e,t)=>{if(t&&e.indexOf(t)===-1)return{};let r=e.trim().split(";"),s={};for(let n of r){n=n.trim();let i=n.indexOf("=");if(i===-1)continue;let o=n.substring(0,i).trim();if(t&&t!==o||!nt.test(o))continue;let h=n.substring(i+1).trim();if(h.startsWith('"')&&h.endsWith('"')&&(h=h.slice(1,-1)),it.test(h)&&(s[o]=h.indexOf("%")!==-1?_(h,C):h,t))break}return s},"parse");var ot=l((e,t,r={})=>{let s=`${e}=${t}`;if(e.startsWith("__Secure-")&&!r.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!r.secure)throw new Error("__Host- Cookie must have Secure attributes");if(r.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(r.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(r&&typeof r.maxAge=="number"&&r.maxAge>=0){if(r.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${r.maxAge|0}`}if(r.domain&&r.prefix!=="host"&&(s+=`; Domain=${r.domain}`),r.path&&(s+=`; Path=${r.path}`),r.expires){if(r.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite&&(s+=`; SameSite=${r.sameSite.charAt(0).toUpperCase()+r.sameSite.slice(1)}`),r.priority&&(s+=`; Priority=${r.priority.charAt(0).toUpperCase()+r.priority.slice(1)}`),r.partitioned){if(!r.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},"_serialize"),K=l((e,t,r)=>(t=encodeURIComponent(t),ot(e,t,r)),"serialize");var ce=l((e,t,r)=>{let s=e.req.raw.headers.get("Cookie");if(typeof t=="string"){if(!s)return;let i=t;return r==="secure"?i="__Secure-"+t:r==="host"&&(i="__Host-"+t),ae(s,i)[i]}return s?ae(s):{}},"getCookie");var at=l((e,t,r)=>{let s;return r?.prefix==="secure"?s=K("__Secure-"+e,t,{path:"/",...r,secure:!0}):r?.prefix==="host"?s=K("__Host-"+e,t,{...r,path:"/",secure:!0,domain:void 0}):s=K(e,t,{path:"/",...r}),s},"generateCookie"),he=l((e,t,r,s)=>{let n=at(t,r,s);e.header("Set-Cookie",n,{append:!0})},"setCookie");var G=new oe;G.use("/*",Ie());G.use("/*",async(e,t)=>{let r=e.env.ACCESS_PASSWORD;return!r||ce(e,"__sp_auth")===r?t():e.req.method==="POST"&&(await e.req.parseBody()).password===r?(he(e,"__sp_auth",r,{path:"/",secure:!0,httpOnly:!0,sameSite:"Lax",maxAge:86400*7}),e.redirect("/")):e.html(ct())});G.all("/*",async e=>{let t=e.req.url,r=new URL(t),s=r.origin,n=r.pathname+r.search,i=t.replace(s+"/","");if(i===""||i==="/")return e.html(ht(s));if(!i.startsWith("http")){let a="",c=e.req.header("Referer");if(c&&c.startsWith(s)){let f=c.replace(s+"/","").match(/^https?:\/\/[^\/]+/);f&&(a=f[0])}if(!a){let u=ce(e,"__sp_origin");u&&u.startsWith("http")&&(a=u)}if(a)i=`${a}${n}`;else if(i.includes("."))i="https://"+i;else return e.text("\u65E0\u6CD5\u89E3\u6790\u76EE\u6807 URL",400)}let o;try{o=new URL(i)}catch{return e.text("\u65E0\u6548\u7684\u76EE\u6807 URL",400)}let h=new Headers(e.req.header());h.set("Host",o.host),h.set("Referer",o.origin),h.set("Origin",o.origin),h.delete("cf-connecting-ip"),h.delete("cf-ipcountry"),h.delete("cf-ray"),h.delete("cf-visitor");try{let a=await fetch(o.href,{method:e.req.method,headers:h,body:e.req.raw.body,redirect:"manual"}),c=new Headers(a.headers);if(c.set("Access-Control-Allow-Origin","*"),c.delete("Content-Security-Policy"),c.delete("X-Frame-Options"),c.delete("Referrer-Policy"),c.has("Location")){let d=c.get("Location");d&&(d.startsWith("http")?c.set("Location",`${s}/${d}`):d.startsWith("//")?c.set("Location",`${s}/https:${d}`):d.startsWith("/")&&c.set("Location",`${s}/${o.origin}${d}`))}let u=a.headers.getSetCookie();if(u.length>0){c.delete("Set-Cookie");for(let d of u)c.append("Set-Cookie",d.replace(/Domain=[^;]+;?/gi,""))}let f=c.get("content-type");return f&&f.includes("text/html")?(he(e,"__sp_origin",o.origin,{path:"/",secure:!0,httpOnly:!0,sameSite:"None",maxAge:864e3}),new HTMLRewriter().on('meta[http-equiv="refresh"]',new V(s,o.origin)).on('meta[name="referrer"]',{element(d){d.remove()}}).on("head",{element(d){d.append(`
                        <script>
                            window.__SP_ORIGIN__ = "${o.origin}";
                            window.__SP_WORKER__ = "${s}";
                            document.addEventListener('click', e => {
                                const a = e.target.closest('a');
                                if (a && a.href && !a.href.startsWith(window.__SP_WORKER__) && !a.href.startsWith('javascript:')) {
                                    e.preventDefault();
                                    window.location.href = window.__SP_WORKER__ + '/' + a.href;
                                }
                            }, true);
                            const originalOpen = window.open;
                            window.open = function(url, ...args) {
                                if (url && typeof url === 'string' && !url.startsWith(window.__SP_WORKER__)) {
                                    url = window.__SP_WORKER__ + '/' + url;
                                }
                                return originalOpen.call(window, url, ...args);
                            };
                        <\/script>
                        `,{html:!0})}}).on("a",new v("href",s,o.origin)).on("img",new v("src",s,o.origin)).on("link",new v("href",s,o.origin)).on("script",new v("src",s,o.origin)).on("form",new v("action",s,o.origin)).on("iframe",new v("src",s,o.origin)).on("*",{element(d){for(let g of["data-src","data-href","data-url"]){let w=d.getAttribute(g);w&&(w.startsWith("http")?d.setAttribute(g,`${s}/${w}`):w.startsWith("/")&&d.setAttribute(g,`${s}/${o.origin}${w}`))}}}).transform(new Response(a.body,{status:a.status,headers:c}))):new Response(a.body,{status:a.status,headers:c})}catch(a){return e.text(`\u4EE3\u7406\u9519\u8BEF: ${a}`,500)}});var v=class{constructor(t,r,s){this.attr=t;this.workerOrigin=r;this.targetOrigin=s}element(t){let r=t.getAttribute(this.attr);if(r){if(r.startsWith(this.workerOrigin))return;r.startsWith("http")?t.setAttribute(this.attr,`${this.workerOrigin}/${r}`):r.startsWith("//")?t.setAttribute(this.attr,`${this.workerOrigin}/https:${r}`):r.startsWith("/")&&t.setAttribute(this.attr,`${this.workerOrigin}/${this.targetOrigin}${r}`)}}};l(v,"ElementHandler");var V=class{constructor(t,r){this.workerOrigin=t;this.targetOrigin=r}element(t){let r=t.getAttribute("content");if(r){let s=r.split(/url=/i);if(s.length===2){let n=s[1].trim();n.startsWith("http")?n=`${this.workerOrigin}/${n}`:n.startsWith("/")&&(n=`${this.workerOrigin}/${this.targetOrigin}${n}`),t.setAttribute("content",`${s[0]}url=${n}`)}}}};l(V,"MetaRefreshHandler");function ct(){return F`
    <!DOCTYPE html>
    <html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SiteProxy - È™åËØÅ</title>
        <style>
            body { margin: 0; font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0f172a, #1e1b4b); color: white; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
            .box { background: rgba(255,255,255,0.05); padding: 40px; border-radius: 16px; text-align: center; max-width: 360px; }
            h1 { margin-bottom: 20px; }
            input { width: 100%; padding: 12px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; background: transparent; color: white; font-size: 1rem; margin-bottom: 16px; box-sizing: border-box; }
            button { width: 100%; padding: 12px; background: #6366f1; border: none; color: white; font-weight: bold; border-radius: 8px; cursor: pointer; }
        </style>
    </head>
    <body>
        <div class="box">
            <h1>üîí ËÆøÈóÆÈ™åËØÅ</h1>
            <form method="POST">
                <input type="password" name="password" placeholder="ËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å" required autofocus>
                <button type="submit">È™åËØÅ</button>
            </form>
        </div>
    </body>
    </html>
    `}l(ct,"renderLoginPage");var Ne;function ht(e){let t=[{name:"Brave Search",url:"https://search.brave.com",icon:"\u{1F981}"},{name:"Wikipedia",url:"https://www.wikipedia.org",icon:"\u{1F4D6}"},{name:"Duck AI",url:"https://duckduckgo.com/?ia=chat",icon:"\u{1F986}"},{name:"GitHub Trending",url:"https://github.com/trending",icon:"\u{1F4C8}"},{name:"Time",url:"https://time.com",icon:"\u23F1\uFE0F"},{name:"Reddit",url:"https://www.reddit.com",icon:"\u{1F525}"}];return F(Ne||(Ne=de([`
    <!DOCTYPE html>
    <html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SiteProxy - \u6781\u901F\u5BFC\u822A</title>
        <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
        <style>
            :root { --primary: #6366f1; }
            body { margin: 0; font-family: 'Outfit', sans-serif; background: linear-gradient(135deg, #0f172a, #1e1b4b); color: #f8fafc; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
            .container { max-width: 800px; width: 100%; text-align: center; animation: fadeIn 0.8s ease-out; }
            @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
            h1 { font-size: 3.5rem; font-weight: 600; margin-bottom: 0.5rem; background: linear-gradient(to right, #818cf8, #c084fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
            p { color: #94a3b8; font-size: 1.1rem; margin-bottom: 2.5rem; }
            .search-box { background: rgba(255,255,255,0.05); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); padding: 10px; border-radius: 20px; display: flex; margin-bottom: 3rem; transition: all 0.3s; }
            .search-box:focus-within { border-color: var(--primary); box-shadow: 0 0 20px rgba(99,102,241,0.3); transform: scale(1.02); }
            input { background: transparent; border: none; color: white; flex: 1; padding: 15px 25px; font-size: 1.1rem; outline: none; }
            button { background: var(--primary); border: none; color: white; padding: 0 30px; border-radius: 12px; font-weight: 600; cursor: pointer; }
            .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 20px; }
            .card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 25px 15px; border-radius: 24px; text-decoration: none; color: white; transition: all 0.4s; display: flex; flex-direction: column; align-items: center; gap: 12px; }
            .card:hover { transform: translateY(-8px); border-color: rgba(99,102,241,0.5); background: rgba(255,255,255,0.1); }
            .card-icon { font-size: 2rem; }
            footer { margin-top: auto; padding: 40px; color: #64748b; font-size: 0.9rem; }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>SiteProxy</h1>
            <p>\u81EA\u7531\u3001\u5B89\u5168\u3001\u9690\u79C1\u7684\u5168\u7403\u7F51\u7EDC\u8BBF\u95EE\u5165\u53E3</p>
            <div class="search-box">
                <input type="text" id="urlInput" placeholder="\u8F93\u5165\u7F51\u5740 (\u4F8B\u5982: reddit.com)" onkeypress="if(event.keyCode==13) go()">
                <button onclick="go()">\u7ACB\u5373\u524D\u5F80</button>
            </div>
            <div class="grid">
                `,`
            </div>
        </div>
        <footer>&copy; 2026 SiteProxy</footer>
        <script>
            function go() {
                const v = document.getElementById('urlInput').value.trim();
                if (!v) return;
                window.location.href = '`,`/' + (v.startsWith('http') ? v : 'https://' + v);
            }
        <\/script>
    </body>
    </html>
    `])),t.map(r=>F`
                    <a href="${e}/${r.url}" class="card">
                        <span class="card-icon">${r.icon}</span>
                        <span class="card-name">${r.name}</span>
                    </a>
                `),e)}l(ht,"renderHomePage");var us=G;export{us as default};
//# sourceMappingURL=index.js.map
